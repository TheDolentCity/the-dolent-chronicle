---
import { getCollection } from "astro:content";
import { ThemeSelect } from "@/components/themes/ThemeSelect";
import BaseLayout from "@/layouts/BaseLayout.astro";
import FormattedDate from "@/components/FormattedDate.astro";
import Prose from "@/components/Prose.astro";
import { SITE_DESCRIPTION } from "@/constants";

const posts = (await getCollection("posts")).sort((a, b) => b.data.published.valueOf() - a.data.published.valueOf());
---

<BaseLayout>
	<section class="max-w-[64rem] mx-auto py-16">
		<Prose>
			<div class="flex gap-4 mb-4 items-end justify-between">
				<h1 class="!m-0 text-3xl lg:text-5xl tracking-tight font-normal">The Dolent Chronicle</h1>
				<ThemeSelect client:visible />
			</div>
			<p class="!mt-0 lg:!mt-6 text-lg lg:text-lg leading-normal">
				{SITE_DESCRIPTION}
			</p>
			<hr />
			<ul class="not-prose">
				{
					posts.map((post) => (
						<li>
							<a
								href={`/posts/${post.id}/`}
								class="group flex px-2 py-2 items-center justify-between text-base rounded hover:bg-zinc-400/30 dark:hover:bg-zinc-900 mst"
							>
								<h4 class="flex-none truncate text-zinc-900 dark:text-zinc-100">{post.data.title}</h4>
								<span class="hidden sm:flex grow w-full h-px mx-4 border-t border-dashed border-zinc-500 dark:border-zinc-700" />
								<p class="flex-none truncate text-sm text-zinc-600 dark:text-zinc-400">
									<FormattedDate date={post.data.published} />
								</p>
							</a>
						</li>
					))
				}
			</ul>
		</Prose>
	</section>
</BaseLayout>
